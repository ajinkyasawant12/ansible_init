---

    - name: Upload MongoDB .repo file (RHEL/CentOS)
          template:
            src: mongodb-org.repo.j2
            dest: "/etc/yum.repos.d/mongodb-org-{{ mongodb_version }}.repo"
            owner: root
            group: root
            mode: 0644
      
    - name: Install MongoDB prerequisites (RHEL/CentOS)
      yum:
        name:
          - gnupg
          - libcurl
          - wget
          - redhat-lsb-core
          - gcc-c++
          - make
        state: present
      
    - name: Add MongoDB GPG key (RHEL/CentOS)
      rpm_key:
        key: https://www.mongodb.org/static/pgp/server-{{ mongodb_version }}.asc
        state: present
      

    - name: Add MongoDB repository (RHEL/CentOS)
      yum_repository:
        name: mongodb-org
        description: MongoDB Repository
        baseurl: https://repo.mongodb.org/yum/{{ os_info.ansible_facts['ansible_distribution'].lower() }}/{{ ansible_distribution_major_version }}/mongodb-org/{{ mongodb_version }}/x86_64/
        enabled: yes
        gpgcheck: yes
        gpgkey: https://www.mongodb.org/static/pgp/server-{{ mongodb_version }}.asc
      
    - name: Install MongoDB package (RHEL/CentOS)
      yum:
        name: mongodb-org
        state: present
      
    - name: Start and enable MongoDB service
      service:
        name: mongod
        state: started
        enabled: yes
